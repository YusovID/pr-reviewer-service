#!/bin/bash

# --- НАСТРОЙКА: ЧТО ИСКЛЮЧИТЬ ---
# Паттерны для команды `tree`. Разделены символом `|`.
TREE_IGNORE_PATTERNS=".git|project.txt"

# --- ШАГ 1: ВЫВОД СТРУКТУРЫ ПРОЕКТА ---
echo "========================================"
echo "      PROJECT SOURCE STRUCTURE"
echo "========================================"
echo

# Используем `tree` с флагом -I для игнорирования ненужных файлов и директорий.
# Флаг -F добавляет символы для обозначения типов файлов (например, / для директорий).
tree -F -I "$TREE_IGNORE_PATTERNS"

echo


# --- ШАГ 2: ВЫВОД СОДЕРЖИМОГО ФАЙЛОВ ---
echo "========================================"
echo "        SOURCE FILE CONTENTS"
echo "========================================"
echo

# Используем `find` для поиска всех файлов, которые НЕ соответствуют нашим критериям исключения.
# `find` гораздо мощнее для фильтрации, чем `tree`.
# -path ... -prune -o ... : эффективно отсекает целые директории.
# -not -name ... : исключает файлы по имени.
# -print0 и `read -d $'\0'` : надежный способ обрабатывать любые имена файлов.
find . \
    -path './.git' -prune -o \
    -type f \
    -not -name 'project.txt' \
    -print0 | while IFS= read -r -d $'\0' filepath; do
        
    echo "--- FILE: $filepath ---"
    # Используем `cat` для вывода содержимого файла.
    cat "$filepath"
    echo
    echo
done